/*
 * Copyright (C) 2024, Stephan Mueller <smueller@chronox.de>
 *
 * License: see LICENSE file in root directory
 *
 * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE, ALL OF
 * WHICH ARE HEREBY DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
 * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
 * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
 * USE OF THIS SOFTWARE, EVEN IF NOT ADVISED OF THE POSSIBILITY OF SUCH
 * DAMAGE.
 */

#define _GNU_SOURCE
#include <errno.h>
#include <getopt.h>
#include <stdio.h>
#include <string.h>
#include <time.h>

#include "asn1_encoder.h"
#include "asn1_decoder.h"
#include "binhexbin.h"
#include "conv_be_le.h"
#include "lc_dilithium.h"
#include "lc_sha3.h"
#include "lc_x509_generator.h"
#include "lc_x509_parser.h"
#include "math_helper.h"
#include "ret_checkers.h"
#include "x509.asn1.h"
#include "x509_akid.asn1.h"
#include "x509_basic_constraints.asn1.h"
#include "x509_eku.asn1.h"
#include "x509_cert_generator.h"
#include "x509_cert_parser.h"

static const uint8_t dilithium44_pk[] = {
	0xe1, 0x2a, 0x6a, 0xd7, 0x23, 0x95, 0x34, 0x84, 0xa3, 0x7d, 0x8f, 0xe9,
	0xf8, 0x65, 0x72, 0x80, 0x0f, 0xd4, 0xa1, 0x98, 0x18, 0xf5, 0x16, 0xa7,
	0x9f, 0xed, 0xff, 0x38, 0xeb, 0x90, 0xcf, 0x61, 0xc4, 0x98, 0xe1, 0x15,
	0xf2, 0x95, 0xe6, 0x6d, 0xbc, 0xb1, 0x12, 0x54, 0x59, 0x21, 0x49, 0xc5,
	0xfa, 0x4c, 0x19, 0x5b, 0xbe, 0xdc, 0xbf, 0x6f, 0xef, 0xae, 0x33, 0xa6,
	0x3d, 0xcb, 0xc6, 0x69, 0x15, 0xa2, 0xef, 0x58, 0x5e, 0x81, 0x03, 0x07,
	0x7c, 0x31, 0xb9, 0x4d, 0x4e, 0x27, 0xfa, 0xce, 0xb9, 0xe3, 0xe9, 0x63,
	0x7b, 0xba, 0x6a, 0x09, 0x6a, 0xe2, 0x7c, 0xc1, 0xc9, 0x23, 0xf9, 0x6d,
	0x48, 0x0d, 0x4f, 0xe9, 0xea, 0xef, 0x94, 0x70, 0xec, 0x2b, 0xdd, 0x45,
	0x46, 0x95, 0x3a, 0xb8, 0xc8, 0x32, 0x0d, 0x1d, 0x71, 0x26, 0x5d, 0x27,
	0x95, 0xa4, 0xea, 0x8a, 0x86, 0x23, 0x28, 0xe8, 0x91, 0x14, 0xd6, 0x09,
	0xa9, 0x78, 0x70, 0x2c, 0xbc, 0x9a, 0x42, 0x46, 0x7a, 0x92, 0xde, 0xc7,
	0x00, 0xad, 0x62, 0x48, 0x0c, 0x52, 0x67, 0x3f, 0xb4, 0x99, 0x89, 0xca,
	0x95, 0x58, 0xcc, 0x7d, 0x49, 0x7b, 0x98, 0xc5, 0x30, 0x45, 0xe9, 0x19,
	0xf4, 0x9f, 0xac, 0x69, 0x2c, 0xbb, 0x96, 0x85, 0xee, 0xc5, 0x98, 0x7f,
	0x05, 0x99, 0x53, 0xa2, 0x50, 0x50, 0xfd, 0x90, 0x50, 0x1a, 0x0f, 0x87,
	0x41, 0xd0, 0x06, 0x5c, 0x90, 0xa2, 0xb3, 0x75, 0x33, 0xa9, 0x65, 0xf7,
	0xd1, 0xbf, 0x39, 0x28, 0x38, 0xcc, 0x36, 0xca, 0x1b, 0xd4, 0x0a, 0x50,
	0xda, 0x76, 0x71, 0xc6, 0x84, 0xe4, 0x8a, 0xc5, 0xc8, 0xbb, 0xb1, 0x21,
	0xd0, 0x8d, 0xcf, 0x14, 0xa3, 0x3b, 0x1a, 0x8c, 0x6c, 0xb5, 0xb5, 0x9a,
	0x77, 0x44, 0x99, 0x46, 0x09, 0x6c, 0xb5, 0x6a, 0x94, 0x1f, 0x68, 0xb1,
	0x42, 0xb2, 0xff, 0xa6, 0xea, 0xb0, 0xfe, 0x28, 0x33, 0x24, 0x0e, 0x28,
	0x52, 0xda, 0x8b, 0x22, 0x04, 0xf6, 0x33, 0x39, 0x66, 0x9c, 0x5f, 0x3b,
	0x77, 0x59, 0x7f, 0x9b, 0xde, 0xca, 0x85, 0xd2, 0x45, 0xd1, 0x5e, 0xad,
	0xbd, 0x1c, 0xc8, 0x3a, 0xd0, 0x5e, 0x73, 0x08, 0x33, 0x27, 0x60, 0x64,
	0xe3, 0xaa, 0x75, 0xfb, 0xfb, 0x87, 0x7b, 0x46, 0x9f, 0xcc, 0xa9, 0xf2,
	0x15, 0xab, 0x06, 0x48, 0x82, 0x01, 0x0c, 0x8b, 0xc3, 0xa6, 0xe5, 0x46,
	0xbf, 0x06, 0xd0, 0x8a, 0xb6, 0x74, 0x0d, 0x0b, 0x6e, 0xc2, 0x6d, 0x02,
	0x4e, 0xab, 0x5d, 0xd9, 0xa4, 0x65, 0x4b, 0x85, 0xb8, 0xf4, 0x75, 0x48,
	0x3c, 0xc4, 0xf4, 0xce, 0x98, 0xd2, 0xb8, 0x26, 0x4d, 0x27, 0x49, 0x6c,
	0x64, 0xcd, 0x2e, 0xf2, 0xe1, 0x9f, 0x84, 0xa5, 0x64, 0xd5, 0x44, 0x10,
	0xbb, 0x3a, 0xde, 0x7d, 0x6f, 0x51, 0xd7, 0x64, 0xb9, 0xba, 0x1d, 0xff,
	0xb3, 0x15, 0x68, 0xd3, 0x99, 0xde, 0x06, 0x48, 0xcd, 0x7d, 0xee, 0x68,
	0x28, 0xf9, 0x93, 0x5b, 0x0b, 0xfe, 0x8c, 0x71, 0x0f, 0x13, 0x91, 0xe5,
	0x26, 0x6a, 0x7b, 0x58, 0xca, 0xdd, 0x3f, 0xa1, 0xc5, 0x62, 0x40, 0xf8,
	0xf7, 0x5f, 0x0c, 0x2b, 0x42, 0x77, 0x7c, 0x5b, 0x7a, 0xe4, 0xcc, 0xdc,
	0x35, 0x86, 0xe9, 0x16, 0x1e, 0x0c, 0x75, 0xd2, 0x2e, 0xfc, 0xbb, 0xd3,
	0x90, 0xa2, 0xb2, 0x08, 0x2c, 0xb5, 0xcf, 0x1f, 0xf8, 0xe2, 0x38, 0x4d,
	0xc7, 0x10, 0xed, 0x39, 0x38, 0xce, 0xf5, 0xbe, 0x6f, 0x12, 0x91, 0x00,
	0x62, 0x72, 0x95, 0x7a, 0x07, 0x79, 0xe3, 0x8c, 0x4f, 0x00, 0xad, 0xdd,
	0xf3, 0xb2, 0x70, 0x1d, 0x5f, 0x09, 0x08, 0xd3, 0x75, 0xe8, 0xe5, 0x6e,
	0x24, 0xbf, 0x6c, 0x32, 0xad, 0x2e, 0x26, 0x69, 0x27, 0x3f, 0xca, 0x39,
	0xa8, 0x33, 0x57, 0xb5, 0x80, 0x4b, 0x3f, 0x41, 0x53, 0x7a, 0xcf, 0xe4,
	0x4f, 0x8e, 0x6a, 0xdf, 0xfa, 0xdf, 0x69, 0x9e, 0x48, 0x62, 0x93, 0x43,
	0xfc, 0xf0, 0x6d, 0x78, 0x7d, 0xe8, 0xc8, 0x4e, 0x3e, 0x1c, 0x5c, 0xe8,
	0xf1, 0xbb, 0x75, 0xf0, 0x8a, 0x71, 0x2b, 0xbb, 0x10, 0x9a, 0x7b, 0x69,
	0x78, 0xca, 0xc2, 0xf6, 0x32, 0xa8, 0x3a, 0xa8, 0xe2, 0x78, 0xb5, 0x3e,
	0x40, 0x3d, 0xfc, 0x41, 0xfd, 0xe0, 0x7b, 0x93, 0x51, 0x98, 0xab, 0xa0,
	0xf9, 0x38, 0x83, 0xc0, 0x94, 0x3e, 0xb7, 0xc3, 0x31, 0x23, 0xe8, 0xc2,
	0xc0, 0xb1, 0x30, 0x76, 0xaa, 0x45, 0x2d, 0xde, 0x43, 0x56, 0xdc, 0xfb,
	0x54, 0x27, 0x00, 0xe5, 0x79, 0x0e, 0x6c, 0xee, 0xf7, 0x52, 0xc1, 0x5f,
	0x07, 0xfa, 0x5d, 0x0e, 0xe4, 0xa2, 0x0b, 0x22, 0xa5, 0x13, 0x33, 0xfd,
	0x06, 0x11, 0x0d, 0x59, 0x18, 0x2d, 0xa7, 0xa1, 0x1f, 0x46, 0x36, 0x71,
	0x4a, 0x9d, 0x1a, 0x7e, 0xb5, 0xce, 0x8c, 0x23, 0x69, 0xa6, 0x97, 0x8c,
	0x6c, 0xa2, 0xae, 0x90, 0x3f, 0xa8, 0x8e, 0x04, 0x39, 0xfe, 0x74, 0x4b,
	0x5d, 0x7e, 0x68, 0x8e, 0xf1, 0x22, 0x72, 0x7e, 0x31, 0x61, 0xaa, 0xcb,
	0x38, 0x67, 0xbc, 0xae, 0xbc, 0x2e, 0x71, 0xb0, 0x07, 0x2f, 0x34, 0x85,
	0xe9, 0xdd, 0x4c, 0x3c, 0x5d, 0x15, 0x5b, 0xc4, 0x3f, 0x1b, 0x5b, 0xb1,
	0xa1, 0x06, 0x64, 0xfd, 0x33, 0x2f, 0xee, 0x7b, 0xc7, 0x8d, 0x42, 0xd0,
	0x9e, 0xdb, 0x01, 0x1b, 0xa8, 0x7e, 0xa3, 0x2c, 0x6e, 0xdc, 0x6f, 0x30,
	0x72, 0x70, 0xb8, 0xc3, 0xfc, 0xd3, 0x8c, 0xd1, 0xfc, 0xae, 0x0e, 0x70,
	0x87, 0x16, 0x8c, 0x7b, 0xc9, 0x65, 0xde, 0x91, 0xde, 0x4a, 0xba, 0x90,
	0x3c, 0x26, 0x8f, 0x59, 0x5b, 0x0f, 0xc5, 0x82, 0x3a, 0x72, 0xb4, 0xf1,
	0x83, 0xbc, 0xa4, 0x75, 0xc6, 0xc7, 0x5b, 0x0e, 0x05, 0x19, 0x39, 0x03,
	0xde, 0x38, 0xa7, 0xa4, 0xa0, 0xec, 0xa6, 0x2e, 0x8c, 0xaf, 0x22, 0xdf,
	0x2a, 0x14, 0x36, 0xfd, 0xce, 0x27, 0xeb, 0xca, 0xb9, 0xda, 0x51, 0x4f,
	0x6d, 0xed, 0xa0, 0xca, 0xba, 0xf4, 0xaa, 0x8b, 0x63, 0x55, 0x50, 0x38,
	0xb5, 0xd4, 0x9c, 0x02, 0x48, 0x8d, 0x18, 0xe9, 0x33, 0x03, 0x22, 0xef,
	0x56, 0x30, 0xad, 0x20, 0xce, 0x88, 0x67, 0xfb, 0x82, 0x0c, 0x23, 0xda,
	0x7c, 0xbc, 0x6e, 0x2f, 0x98, 0x1d, 0x74, 0x77, 0x77, 0x51, 0x71, 0xf4,
	0x0d, 0xd0, 0xad, 0x82, 0x1b, 0x8b, 0x6f, 0x97, 0xee, 0x04, 0xa0, 0x60,
	0x6f, 0x2a, 0xae, 0xa0, 0xba, 0x07, 0xe6, 0xb0, 0xf3, 0xbd, 0x73, 0x7d,
	0xbb, 0xbf, 0x48, 0xd9, 0xeb, 0x8f, 0x79, 0xff, 0x17, 0x5c, 0x45, 0x34,
	0x48, 0xa8, 0x39, 0xef, 0x68, 0x2b, 0xca, 0x70, 0x5d, 0x3d, 0xb5, 0xd5,
	0xe5, 0x20, 0xe2, 0xb6, 0x09, 0x44, 0x1a, 0x2e, 0xdb, 0x95, 0xcc, 0x56,
	0x50, 0x40, 0x5d, 0xc0, 0xc6, 0x13, 0x4d, 0x77, 0x73, 0x47, 0x9a, 0x23,
	0x67, 0x2c, 0x0e, 0x01, 0x50, 0xfd, 0x24, 0x74, 0xa2, 0xca, 0x0f, 0xbe,
	0x14, 0x4a, 0x9b, 0xcb, 0xee, 0xd1, 0xde, 0x95, 0x38, 0x8c, 0xe7, 0x8f,
	0x15, 0xcb, 0xd9, 0x2c, 0x21, 0x12, 0xaa, 0xd9, 0xad, 0x31, 0x9e, 0x18,
	0x9e, 0x74, 0x8b, 0x5b, 0x10, 0x5d, 0x71, 0xc8, 0x5a, 0x9e, 0x25, 0x05,
	0x83, 0x6b, 0xc9, 0x02, 0xcb, 0x31, 0xdf, 0x51, 0xbc, 0x27, 0x11, 0x55,
	0xec, 0x8e, 0xf7, 0x81, 0xf4, 0x93, 0xe9, 0xb5, 0x5b, 0x7b, 0x19, 0xef,
	0x9d, 0xea, 0xca, 0x7b, 0x4d, 0x00, 0xd3, 0x31, 0x1a, 0x23, 0xd5, 0x98,
	0xa5, 0x94, 0xec, 0x63, 0xb6, 0x5f, 0x09, 0x92, 0x1e, 0x74, 0x18, 0x84,
	0x72, 0xd1, 0x2b, 0x2f, 0x73, 0x93, 0xff, 0xb2, 0x37, 0xdc, 0xef, 0x91,
	0xa5, 0x74, 0x9c, 0x90, 0x3b, 0xe5, 0xe2, 0x06, 0xf6, 0x8b, 0x22, 0xd3,
	0x70, 0xf7, 0xa5, 0x43, 0x75, 0x87, 0x9e, 0xb9, 0x00, 0xa6, 0x73, 0xe2,
	0x87, 0x87, 0x22, 0xc6, 0x02, 0x95, 0x5a, 0xed, 0xfa, 0xaa, 0x1f, 0xaa,
	0xf5, 0xe7, 0x4a, 0x2c, 0x18, 0x49, 0x94, 0x9d, 0x76, 0x78, 0x2c, 0x6b,
	0xcf, 0x25, 0xad, 0xc6, 0xae, 0x10, 0xd5, 0x22, 0xb0, 0x80, 0xa6, 0x45,
	0x7b, 0x30, 0xfa, 0x8b, 0xfb, 0x4b, 0xa4, 0x10, 0xf7, 0x26, 0xaa, 0x09,
	0x45, 0x3f, 0xf0, 0x2d, 0xf2, 0x68, 0x55, 0x7c, 0xeb, 0xed, 0x94, 0x50,
	0xe8, 0x98, 0xcd, 0x8c, 0x06, 0x5d, 0xca, 0xae, 0x52, 0xe7, 0x28, 0x34,
	0xfe, 0x9c, 0x35, 0x35, 0x53, 0xd4, 0x0e, 0x85, 0xe2, 0x8c, 0xc5, 0x55,
	0x95, 0xe6, 0x9d, 0x2f, 0x4f, 0x7b, 0x86, 0xe4, 0x77, 0x1d, 0xd6, 0xdf,
	0xf0, 0x6a, 0xca, 0x54, 0x59, 0x6b, 0xc9, 0x6e, 0x0f, 0x1c, 0x4f, 0xf6,
	0x10, 0x5d, 0x83, 0x3b, 0xba, 0x3f, 0xd6, 0xab, 0xc3, 0x66, 0xca, 0x87,
	0xf6, 0xe6, 0x08, 0xd2, 0xa7, 0xe1, 0xa2, 0x2d, 0x2d, 0xc7, 0x06, 0x8b,
	0x2f, 0xcc, 0xde, 0x01, 0xcf, 0x81, 0x14, 0xb5, 0x77, 0x04, 0x4d, 0x18,
	0xaf, 0xaa, 0x70, 0xa1, 0x90, 0x3e, 0x95, 0x83, 0x6f, 0xda, 0xd2, 0xd9,
	0x15, 0xe8, 0x36, 0x26, 0x23, 0x78, 0x8b, 0xff, 0x97, 0xf9, 0xf0, 0x0e,
	0x31, 0x43, 0x38, 0x1e, 0xdf, 0xfd, 0x75, 0x49, 0xd2, 0x15, 0x77, 0x22,
	0x96, 0xb4, 0x82, 0x06, 0xb7, 0x96, 0xbd, 0xb6, 0xcd, 0xd2, 0x90, 0x81,
	0xe5, 0x9e, 0x48, 0x1c, 0x4e, 0x3d, 0xfe, 0x46, 0x35, 0x63, 0x26, 0xbb,
	0x0a, 0x02, 0xb0, 0x0e, 0xf0, 0x5e, 0x0a, 0xd5, 0x16, 0x0c, 0xc7, 0xf2,
	0x91, 0x32, 0x95, 0x00, 0x3d, 0x32, 0x3f, 0x74, 0xac, 0x85, 0xfc, 0x6d,
	0xfe, 0xb2, 0x79, 0x73, 0xa8, 0x13, 0x66, 0x71, 0x3b, 0xb8, 0x50, 0x98,
	0x16, 0xab, 0xd0, 0xf8, 0x4b, 0x68, 0x52, 0x6d, 0x22, 0x21, 0x89, 0xdc,
	0x69, 0x40, 0xee, 0xb1, 0xda, 0x9c, 0x11, 0x62, 0x31, 0x79, 0xb7, 0x5c,
	0xd3, 0xa6, 0xeb, 0xbb,
};

static const uint8_t dilithium44_sk[] = {
	0xe1, 0x2a, 0x6a, 0xd7, 0x23, 0x95, 0x34, 0x84, 0xa3, 0x7d, 0x8f, 0xe9,
	0xf8, 0x65, 0x72, 0x80, 0x0f, 0xd4, 0xa1, 0x98, 0x18, 0xf5, 0x16, 0xa7,
	0x9f, 0xed, 0xff, 0x38, 0xeb, 0x90, 0xcf, 0x61, 0xd9, 0x51, 0x9f, 0xb3,
	0x8e, 0xce, 0x5f, 0x34, 0xf0, 0x39, 0xad, 0xef, 0x04, 0x0d, 0x35, 0xac,
	0x5f, 0xcf, 0x16, 0x66, 0x49, 0xa4, 0x4c, 0xbc, 0x76, 0xe0, 0x21, 0x18,
	0x6e, 0x47, 0x58, 0x15, 0x41, 0x5c, 0x01, 0x87, 0x19, 0x4c, 0x16, 0x9a,
	0x14, 0x45, 0xef, 0x48, 0xfa, 0x94, 0x50, 0xda, 0xee, 0x9f, 0xcf, 0x2f,
	0x10, 0xf4, 0xa5, 0xa9, 0xa7, 0xdb, 0xd3, 0xc3, 0xaa, 0xa1, 0xf2, 0x29,
	0x8f, 0x91, 0x69, 0xc4, 0xcb, 0xfd, 0x10, 0x8b, 0x95, 0x29, 0x50, 0x89,
	0x41, 0x3e, 0xca, 0x98, 0x50, 0x16, 0xd5, 0x40, 0x26, 0x8f, 0x1a, 0x6b,
	0xfa, 0xe6, 0x37, 0xa4, 0xf3, 0xab, 0x2e, 0x41, 0x13, 0x14, 0x0d, 0x0c,
	0x85, 0x91, 0x61, 0x36, 0x85, 0xe1, 0x04, 0x51, 0x19, 0xa3, 0x71, 0x9a,
	0xa4, 0x84, 0x12, 0x16, 0x65, 0xc0, 0xb0, 0x21, 0xa1, 0xa8, 0x28, 0x18,
	0x88, 0x89, 0x09, 0x97, 0x31, 0x4c, 0x92, 0x85, 0x13, 0xc6, 0x30, 0x4c,
	0x90, 0x70, 0x24, 0x88, 0x0d, 0x23, 0x44, 0x91, 0x63, 0x10, 0x8c, 0x59,
	0x46, 0x92, 0x22, 0x32, 0x6e, 0x60, 0x26, 0x64, 0x03, 0xb7, 0x80, 0xca,
	0xb6, 0x24, 0x0a, 0x48, 0x49, 0x0c, 0x91, 0x8d, 0xdc, 0x20, 0x90, 0x00,
	0x00, 0x60, 0x91, 0x32, 0x12, 0x5a, 0xc6, 0x80, 0x64, 0x02, 0x09, 0x84,
	0x48, 0x89, 0xa0, 0x46, 0x2e, 0xa2, 0x44, 0x29, 0x9a, 0x26, 0x08, 0xd3,
	0xc0, 0x29, 0x11, 0x87, 0x08, 0xe3, 0xc4, 0x89, 0xa4, 0xb6, 0x50, 0x52,
	0x08, 0x6c, 0x20, 0x35, 0x6d, 0x53, 0xa2, 0x70, 0x1a, 0x37, 0x40, 0x49,
	0x34, 0x4e, 0x1a, 0x18, 0x69, 0x22, 0x97, 0x11, 0x1c, 0xa1, 0x48, 0x50,
	0x26, 0x4e, 0xc2, 0x88, 0x4d, 0x4c, 0x20, 0x86, 0x02, 0x08, 0x02, 0x00,
	0x03, 0x40, 0x04, 0x39, 0x82, 0xc1, 0x22, 0x65, 0x51, 0xa4, 0x90, 0x1c,
	0xc9, 0x45, 0xd2, 0x44, 0x00, 0x14, 0x17, 0x0a, 0xca, 0x48, 0x49, 0x1c,
	0x12, 0x02, 0x91, 0x14, 0x32, 0x02, 0x25, 0x70, 0x50, 0xa4, 0x41, 0x8a,
	0x84, 0x31, 0x5c, 0x34, 0x49, 0x93, 0x32, 0x24, 0x0c, 0xa4, 0x20, 0x11,
	0xc0, 0x2c, 0x8c, 0xb8, 0x70, 0x52, 0x46, 0x60, 0x9c, 0x00, 0x6c, 0xc0,
	0x28, 0x92, 0x89, 0xb6, 0x20, 0x02, 0x03, 0x86, 0x5b, 0x14, 0x08, 0x24,
	0xa3, 0x6c, 0x80, 0x14, 0x6c, 0xa1, 0x88, 0x20, 0x4c, 0xb6, 0x11, 0xdc,
	0x12, 0x24, 0x4b, 0x10, 0x09, 0xd0, 0x40, 0x60, 0x04, 0x41, 0x92, 0x18,
	0x19, 0x40, 0x00, 0xc3, 0x04, 0x14, 0x34, 0x61, 0x08, 0x02, 0x68, 0x00,
	0xa8, 0x00, 0x60, 0x46, 0x12, 0x21, 0x28, 0x46, 0xd8, 0x40, 0x61, 0x0c,
	0xa5, 0x71, 0x22, 0x42, 0x22, 0xa4, 0x26, 0x6e, 0xdc, 0x10, 0x05, 0x59,
	0x48, 0x2e, 0x82, 0x80, 0x85, 0x19, 0x22, 0x06, 0x1c, 0x35, 0x20, 0x1c,
	0x46, 0x88, 0x1c, 0x41, 0x64, 0x61, 0x30, 0x4d, 0x22, 0x27, 0x02, 0x14,
	0xb6, 0x29, 0x20, 0x25, 0x4c, 0x88, 0x94, 0x44, 0x99, 0x82, 0x25, 0xcc,
	0x10, 0x6a, 0x63, 0x02, 0x06, 0x1b, 0x02, 0x6c, 0x61, 0x46, 0x30, 0x0b,
	0x21, 0x2a, 0x1c, 0x08, 0x60, 0x8b, 0x36, 0x2c, 0x8a, 0x90, 0x8d, 0xd3,
	0x00, 0x71, 0x1b, 0xb7, 0x2d, 0xe3, 0xa2, 0x4c, 0x84, 0x30, 0x45, 0x09,
	0xa7, 0x65, 0x41, 0x42, 0x50, 0x94, 0x24, 0x11, 0x49, 0xc0, 0x6d, 0x92,
	0x34, 0x01, 0x04, 0xc9, 0x41, 0x8b, 0xa2, 0x4c, 0x00, 0x37, 0x71, 0x83,
	0x82, 0x00, 0xa1, 0x32, 0x4d, 0x02, 0x08, 0x50, 0x8b, 0x34, 0x6c, 0x09,
	0x11, 0x85, 0x54, 0x38, 0x4e, 0x09, 0x84, 0x24, 0x49, 0x96, 0x70, 0x24,
	0xb1, 0x29, 0x61, 0xb2, 0x4c, 0x13, 0x80, 0x71, 0x22, 0x39, 0x32, 0xa4,
	0x34, 0x45, 0xcb, 0xc6, 0x08, 0x8c, 0x10, 0x41, 0xc0, 0x26, 0x0a, 0x09,
	0x18, 0x6e, 0x00, 0x46, 0x05, 0x5a, 0x36, 0x70, 0x44, 0x24, 0x6c, 0x89,
	0x40, 0x6e, 0x20, 0x93, 0x40, 0x42, 0x86, 0x71, 0xdb, 0x08, 0x0c, 0x18,
	0xa2, 0x6d, 0x12, 0x33, 0x8e, 0x8a, 0x86, 0x64, 0x54, 0x08, 0x05, 0x11,
	0x09, 0x05, 0x1b, 0x23, 0x8d, 0xc9, 0x46, 0x01, 0x83, 0x16, 0x92, 0x03,
	0x94, 0x00, 0x01, 0xb2, 0x2c, 0x54, 0xc2, 0x10, 0x44, 0x90, 0x09, 0x49,
	0xb2, 0x85, 0xa1, 0x80, 0x81, 0x92, 0x24, 0x88, 0x1b, 0xc1, 0x64, 0xc9,
	0x28, 0x88, 0xe1, 0x00, 0x05, 0x99, 0x32, 0x09, 0x8a, 0x84, 0x64, 0x8a,
	0x06, 0x02, 0x01, 0x25, 0x08, 0xda, 0x46, 0x85, 0x02, 0xa6, 0x48, 0x98,
	0x08, 0x02, 0xc1, 0x00, 0x90, 0x48, 0x02, 0x10, 0x60, 0x20, 0x2d, 0x5b,
	0xa2, 0x2d, 0x5b, 0x24, 0x00, 0xa0, 0xb2, 0x45, 0x1a, 0x06, 0x50, 0xe0,
	0xc2, 0x20, 0x4c, 0xa0, 0x84, 0x58, 0x10, 0x72, 0xc4, 0x04, 0x72, 0xd9,
	0x42, 0x41, 0x11, 0xa9, 0x30, 0x90, 0xc2, 0x24, 0xa1, 0xa0, 0x65, 0xe4,
	0xb8, 0x8c, 0x22, 0x04, 0x71, 0x82, 0x28, 0x08, 0xa4, 0x00, 0x85, 0x00,
	0xa9, 0x44, 0x9b, 0x18, 0x51, 0x1b, 0xc5, 0x4d, 0xd0, 0x32, 0x06, 0x83,
	0x96, 0x0c, 0x18, 0xa3, 0x04, 0x8a, 0xa0, 0x48, 0x81, 0x00, 0x02, 0x50,
	0xb0, 0x50, 0x02, 0xb0, 0x91, 0x44, 0x18, 0x60, 0x1c, 0x11, 0x26, 0x50,
	0x30, 0x41, 0x41, 0x10, 0x09, 0x93, 0x24, 0x51, 0x10, 0x30, 0x2c, 0x04,
	0x06, 0x50, 0x12, 0x22, 0x82, 0x50, 0xc2, 0x05, 0x08, 0x37, 0x00, 0x0c,
	0xc0, 0x64, 0x90, 0x94, 0x0d, 0x42, 0x86, 0x80, 0x4a, 0xb4, 0x11, 0x53,
	0x44, 0x22, 0x1b, 0xc3, 0x2d, 0x60, 0xc4, 0x20, 0x53, 0x26, 0x20, 0xc1,
	0x46, 0x65, 0x58, 0x10, 0x64, 0x83, 0x98, 0x84, 0xa0, 0x00, 0x91, 0x4a,
	0x86, 0x2c, 0x1a, 0x41, 0x40, 0x58, 0x30, 0x4c, 0xc0, 0x24, 0x85, 0x11,
	0x40, 0x6e, 0xe1, 0x40, 0x49, 0x01, 0x36, 0x6d, 0x98, 0xa2, 0x10, 0xd3,
	0x22, 0x46, 0xa0, 0x28, 0x0d, 0x44, 0x08, 0x08, 0x10, 0x26, 0x08, 0x92,
	0x24, 0x2d, 0x58, 0xb8, 0x65, 0x9a, 0x32, 0x6c, 0x13, 0x18, 0x08, 0x22,
	0xc2, 0x0c, 0x0b, 0x35, 0x8d, 0x24, 0x46, 0x2c, 0x0b, 0x11, 0x72, 0x91,
	0x28, 0x45, 0xc8, 0x34, 0x66, 0xd0, 0xb8, 0x30, 0xdc, 0x02, 0x44, 0x08,
	0x01, 0x50, 0x13, 0xb0, 0x4d, 0xe1, 0x42, 0x48, 0x8c, 0x08, 0x92, 0x21,
	0x05, 0x04, 0x42, 0xc0, 0x91, 0xc4, 0x34, 0x2a, 0x95, 0xa7, 0xd4, 0x2f,
	0x57, 0x71, 0xf8, 0x8b, 0x48, 0x29, 0xd8, 0x57, 0x15, 0x69, 0x3d, 0x82,
	0x34, 0x3a, 0xf1, 0x8c, 0x89, 0x4a, 0xdf, 0xa2, 0x7e, 0xd1, 0xf0, 0x00,
	0x39, 0x93, 0xa6, 0xaf, 0xc4, 0xb7, 0xfe, 0x46, 0x76, 0x3b, 0x64, 0x39,
	0x8b, 0x34, 0x8f, 0x26, 0x09, 0x51, 0xd9, 0xad, 0xa1, 0x67, 0x67, 0xe3,
	0x6f, 0xe3, 0x9e, 0x2d, 0x39, 0x84, 0x9c, 0xee, 0xef, 0xc9, 0x75, 0xde,
	0x8d, 0xa8, 0x9d, 0xac, 0xff, 0xa1, 0x78, 0x28, 0x45, 0x44, 0xb5, 0x75,
	0xe2, 0x9d, 0x8d, 0xd1, 0x68, 0x0b, 0xd8, 0x95, 0x9a, 0x5f, 0xbe, 0x5e,
	0xb0, 0xe4, 0x2e, 0x78, 0x6d, 0x43, 0x8d, 0xb3, 0xe2, 0x88, 0x52, 0xd0,
	0xa8, 0x83, 0xdc, 0x84, 0x15, 0x18, 0x2d, 0x41, 0x74, 0x2f, 0xe7, 0xa6,
	0x37, 0x4a, 0xdb, 0x0d, 0xf9, 0x1c, 0x49, 0xd1, 0xcf, 0x62, 0xce, 0xbb,
	0xf6, 0xe6, 0xce, 0x29, 0x80, 0xdc, 0x2f, 0x8d, 0x8a, 0x0a, 0xa2, 0x9f,
	0x67, 0xa9, 0xe8, 0xe0, 0xed, 0xf8, 0x6d, 0x24, 0x1d, 0x7e, 0x38, 0x4e,
	0x4a, 0x5d, 0xa1, 0xcd, 0xcd, 0xad, 0x46, 0x95, 0x4c, 0x23, 0x0d, 0x01,
	0x67, 0x3c, 0x4f, 0x4d, 0xf7, 0xff, 0x0e, 0x1e, 0x70, 0x99, 0x8c, 0x68,
	0x2b, 0x32, 0xfe, 0x11, 0x69, 0xa0, 0x5b, 0xe3, 0x63, 0xf8, 0xe5, 0xf0,
	0x25, 0xbd, 0xac, 0x27, 0x47, 0x49, 0x72, 0x29, 0x9d, 0x63, 0x17, 0xe7,
	0xc6, 0xe8, 0x11, 0xe5, 0xd6, 0xfb, 0x1b, 0xcd, 0x6a, 0x8e, 0x25, 0x31,
	0x0c, 0x2b, 0x62, 0x62, 0x49, 0xb0, 0xe2, 0x20, 0xe0, 0x12, 0x01, 0x01,
	0xf1, 0x53, 0xe4, 0x16, 0xac, 0x62, 0x4d, 0x85, 0x79, 0xa2, 0xfd, 0xfe,
	0xc5, 0xc5, 0x22, 0xe4, 0xb1, 0x53, 0x0f, 0x29, 0x57, 0xd3, 0xdb, 0xce,
	0x69, 0x8e, 0x75, 0x1a, 0xdb, 0x28, 0xea, 0xc0, 0xd6, 0x6a, 0x28, 0x4f,
	0x6b, 0xb8, 0xd3, 0x70, 0x92, 0x55, 0x5d, 0x98, 0x29, 0x8c, 0xbd, 0x39,
	0x37, 0x5d, 0xbb, 0x18, 0x7f, 0x8f, 0x04, 0x36, 0xd5, 0xe2, 0x7d, 0x73,
	0xc8, 0x6e, 0x15, 0x48, 0x86, 0x89, 0xd8, 0x1e, 0xc5, 0xea, 0x9f, 0x04,
	0xca, 0x5a, 0xeb, 0xc5, 0xb3, 0x5d, 0xc0, 0xd8, 0x37, 0x3c, 0xd3, 0x15,
	0x76, 0x0e, 0xb1, 0xeb, 0x6a, 0xc9, 0x8a, 0xbc, 0x9b, 0x64, 0x4c, 0x83,
	0xb3, 0xfc, 0xe4, 0x68, 0x2b, 0x4f, 0x8b, 0x81, 0x1d, 0x3b, 0xc6, 0x8b,
	0x43, 0x4b, 0x3e, 0x88, 0xd3, 0xaa, 0xcd, 0x81, 0x7b, 0xb6, 0x57, 0x19,
	0x28, 0x48, 0x01, 0x78, 0x8a, 0xe7, 0x4b, 0x55, 0xed, 0xd8, 0xdf, 0xe4,
	0xa4, 0x91, 0xd8, 0xa0, 0xc8, 0xef, 0x49, 0xb1, 0x45, 0xeb, 0x98, 0x24,
	0xcd, 0x6c, 0xe4, 0x09, 0x73, 0xda, 0xf1, 0x48, 0x85, 0xa1, 0xfa, 0x35,
	0x40, 0xf3, 0x11, 0xf1, 0xe3, 0xe0, 0x4c, 0x43, 0x0a, 0x09, 0x08, 0x66,
	0x4d, 0x84, 0xd4, 0x9e, 0x4a, 0xad, 0xff, 0xd0, 0x8e, 0xc6, 0x33, 0x22,
	0x9f, 0x93, 0x7c, 0x8e, 0xb3, 0xc4, 0x7c, 0x23, 0x4e, 0xbb, 0xce, 0x85,
	0x92, 0x77, 0x5b, 0x08, 0x99, 0xb6, 0xfe, 0x0b, 0x02, 0x19, 0x18, 0x13,
	0xe4, 0xd2, 0xf4, 0x8c, 0xc4, 0x07, 0x2d, 0xef, 0xf0, 0xa6, 0xbe, 0x63,
	0xff, 0xbd, 0x7f, 0xa1, 0xbf, 0xdd, 0x6a, 0xf2, 0xe4, 0xf7, 0xf1, 0x22,
	0x7a, 0x17, 0xf2, 0x7e, 0x5d, 0x6d, 0x78, 0x25, 0x55, 0x8b, 0x12, 0x7d,
	0xd3, 0xbd, 0xf3, 0xde, 0x65, 0x8b, 0xfa, 0x6d, 0xc3, 0xb9, 0x21, 0xe4,
	0xdf, 0x89, 0x2d, 0xdd, 0xac, 0xab, 0x5c, 0xc3, 0x0b, 0xe8, 0xa9, 0x2e,
	0xd1, 0xc7, 0x52, 0x45, 0x22, 0x5e, 0x56, 0x51, 0xb3, 0xa8, 0xb8, 0x61,
	0x62, 0x07, 0x31, 0x63, 0x64, 0x5b, 0xc3, 0x8a, 0x13, 0x2a, 0x4a, 0xe2,
	0x5b, 0x13, 0x6b, 0x41, 0x78, 0xeb, 0xe5, 0xf5, 0x3c, 0x78, 0x98, 0x8b,
	0x2a, 0xa6, 0xc1, 0x35, 0x57, 0xd8, 0x10, 0x5b, 0x22, 0xde, 0xb1, 0xa7,
	0x6f, 0xa7, 0x6b, 0x3e, 0x97, 0xa4, 0xab, 0xc5, 0x6d, 0xfe, 0xc2, 0x5f,
	0xc6, 0xdc, 0x8c, 0x29, 0xb1, 0xaa, 0x88, 0x51, 0xbf, 0xbc, 0x0a, 0x83,
	0x1d, 0xbc, 0x21, 0x1c, 0xc7, 0xac, 0xbf, 0xf8, 0xf4, 0xc5, 0xaa, 0xe6,
	0x59, 0x4d, 0x2c, 0x83, 0xc8, 0xeb, 0x7b, 0xc4, 0xc0, 0x60, 0xed, 0x8e,
	0xc3, 0x19, 0x05, 0x89, 0xd8, 0x7b, 0x58, 0x91, 0xea, 0x77, 0x52, 0x1f,
	0x7b, 0xbe, 0x85, 0x79, 0x75, 0x67, 0x72, 0x39, 0x9a, 0x7a, 0xe9, 0x73,
	0xec, 0x84, 0x56, 0xdd, 0x3a, 0x54, 0xdb, 0x95, 0xf2, 0x86, 0xe3, 0x42,
	0xf0, 0x5f, 0xc4, 0xf3, 0xdc, 0x8a, 0x50, 0x54, 0xac, 0x89, 0xcb, 0xd8,
	0x46, 0x59, 0x6d, 0xd2, 0x59, 0xcd, 0x4f, 0x7a, 0x5c, 0xda, 0x83, 0x5a,
	0xfc, 0x7c, 0xdc, 0xaa, 0xde, 0x4e, 0x61, 0x52, 0x3d, 0xff, 0x52, 0x2e,
	0xb6, 0x7a, 0x34, 0xad, 0x2d, 0x66, 0xc5, 0xb3, 0xa2, 0x29, 0x32, 0xbf,
	0x67, 0xc2, 0x33, 0xac, 0x3b, 0x57, 0x0b, 0x44, 0x3e, 0x54, 0xdc, 0x6d,
	0xa7, 0xcf, 0x2c, 0x0b, 0x1e, 0x71, 0xb3, 0xe6, 0xf4, 0x64, 0x5c, 0x61,
	0xdc, 0xaa, 0x59, 0x04, 0x5b, 0x49, 0x1a, 0xed, 0x4e, 0x30, 0x0b, 0xb2,
	0x9d, 0x68, 0xdf, 0x1d, 0x00, 0xb1, 0xf2, 0xee, 0xc2, 0xd5, 0x65, 0xf5,
	0x07, 0x89, 0xcf, 0x46, 0x1a, 0x09, 0x4d, 0x63, 0xf5, 0x3a, 0xcb, 0x45,
	0x7a, 0xfc, 0xe3, 0xbd, 0xda, 0x94, 0x69, 0xb4, 0xf6, 0x57, 0x17, 0x15,
	0xfb, 0x3c, 0x5e, 0xec, 0x80, 0x73, 0xb1, 0x81, 0xc2, 0x72, 0x00, 0xdd,
	0x0e, 0xf6, 0x7a, 0x58, 0x2e, 0xcf, 0x8b, 0xd2, 0xe8, 0x13, 0xe6, 0x09,
	0x84, 0xed, 0xee, 0x0b, 0x78, 0x9e, 0x6c, 0xb3, 0x1d, 0xdd, 0x25, 0xee,
	0xd2, 0x92, 0x17, 0xd1, 0x69, 0x9b, 0xf6, 0x1c, 0x40, 0x4a, 0xb7, 0x8a,
	0xf0, 0xc6, 0x9d, 0x63, 0xc5, 0x2b, 0xc5, 0xe6, 0xf9, 0x21, 0xb9, 0x5b,
	0xdd, 0xc7, 0xac, 0x1b, 0x07, 0x13, 0x6d, 0x07, 0x51, 0x86, 0x84, 0x4e,
	0xc5, 0x94, 0x13, 0x94, 0x5f, 0x16, 0x57, 0xc8, 0x5a, 0x57, 0x06, 0xe2,
	0xca, 0x9f, 0x90, 0xbb, 0xc4, 0xe9, 0x5e, 0xc4, 0x2d, 0xb9, 0xf0, 0xd1,
	0x58, 0x7b, 0x50, 0x80, 0x45, 0x9a, 0x50, 0xa7, 0x5e, 0x90, 0x3f, 0x76,
	0xb5, 0x67, 0x07, 0xaa, 0xd7, 0xa7, 0x5e, 0x6c, 0xd6, 0xa5, 0xb6, 0x83,
	0xb7, 0x6d, 0x00, 0x99, 0xb5, 0x84, 0x6b, 0x0c, 0x99, 0xd3, 0x3f, 0x62,
	0x4c, 0xd7, 0xbc, 0x8b, 0xe9, 0xc5, 0xc7, 0xf8, 0x81, 0x41, 0x94, 0x4b,
	0x20, 0xaf, 0x30, 0xd2, 0xb8, 0xcf, 0xbd, 0xc1, 0x8e, 0x10, 0xba, 0x44,
	0xe0, 0x40, 0x21, 0xbd, 0x69, 0xb6, 0xeb, 0x6f, 0xae, 0x5f, 0x92, 0x00,
	0x5e, 0x6a, 0x14, 0x31, 0x89, 0x90, 0x01, 0x44, 0x78, 0xaa, 0x7c, 0x63,
	0x0d, 0x10, 0xa2, 0x69, 0x01, 0x06, 0x72, 0xeb, 0xca, 0xc9, 0xd7, 0x7e,
	0xd2, 0x11, 0x62, 0x36, 0x80, 0x5c, 0xfe, 0xd8, 0x91, 0x1b, 0xbe, 0x49,
	0x14, 0xe2, 0x92, 0x9b, 0x98, 0x7b, 0x8e, 0x50, 0x3f, 0xa7, 0xd2, 0x33,
	0x06, 0x89, 0x77, 0x26, 0xe4, 0x5e, 0x29, 0x86, 0x64, 0x1e, 0xfe, 0x4d,
	0x84, 0x15, 0x77, 0xa9, 0x7f, 0xe4, 0x6b, 0x50, 0x04, 0xd5, 0x66, 0x9c,
	0xee, 0xa5, 0x66, 0x07, 0xcb, 0xc2, 0x96, 0xfc, 0xba, 0x22, 0x5a, 0x2a,
	0xfa, 0x45, 0x72, 0x74, 0x26, 0xd6, 0xa4, 0xa3, 0xe4, 0x0e, 0x10, 0x4b,
	0xe3, 0xa1, 0xbd, 0x9c, 0xbf, 0x89, 0x49, 0x5b, 0xe5, 0x87, 0xd4, 0x62,
	0xc0, 0xd3, 0x9d, 0x42, 0xf6, 0xa1, 0x2b, 0x7f, 0x89, 0x36, 0x3d, 0xd3,
	0xfc, 0x53, 0xd7, 0xee, 0xd9, 0x88, 0xda, 0xc2, 0xf6, 0xdc, 0xa9, 0x4f,
	0xeb, 0x51, 0x9a, 0xfa, 0x10, 0x70, 0xe5, 0x52, 0xad, 0x73, 0x82, 0xef,
	0x85, 0x37, 0x59, 0x4a, 0x5b, 0x31, 0x2d, 0xac, 0x4f, 0x93, 0x96, 0xa2,
	0xbf, 0xfb, 0x62, 0xc4, 0xf3, 0x3c, 0x65, 0x60, 0x02, 0xea, 0xac, 0x9c,
	0x6a, 0x61, 0xf5, 0x7c, 0xcd, 0x2c, 0x0f, 0xe2, 0x45, 0xbe, 0x79, 0xfa,
	0x56, 0x35, 0xa0, 0xd6, 0x27, 0x81, 0xb5, 0xd1, 0xf7, 0x7f, 0x17, 0x4a,
	0x6c, 0x7f, 0x8b, 0x00, 0x5f, 0xce, 0xc8, 0x78, 0xcc, 0xf5, 0xbe, 0xb4,
	0x80, 0xb0, 0x19, 0x2d, 0x33, 0xe7, 0x7e, 0x2a, 0xea, 0x5c, 0xa4, 0xdd,
	0xc4, 0xf7, 0x7d, 0xab, 0x81, 0x1e, 0x2c, 0xf8, 0xb0, 0x40, 0xd3, 0x87,
	0xf7, 0x7b, 0x9d, 0x09, 0x4a, 0x1d, 0xbb, 0x57, 0x5b, 0x76, 0x27, 0x39,
	0x4c, 0x4f, 0xab, 0x9e, 0x38, 0x17, 0xd4, 0xbe, 0xc6, 0x8a, 0x3c, 0xb8,
	0xb4, 0xd2, 0x0c, 0xbd, 0x49, 0xb6, 0x78, 0x19, 0x78, 0xfe, 0xe8, 0x98,
	0xca, 0x1b, 0xe8, 0xee, 0x19, 0x03, 0x3e, 0x5a, 0x5d, 0x08, 0xb8, 0x8d,
	0xf4, 0x0c, 0xad, 0x57, 0xbc, 0xb1, 0x25, 0x3d, 0xf1, 0x0b, 0x29, 0xb6,
	0x06, 0x1f, 0xee, 0x17, 0x58, 0x47, 0xde, 0x7e, 0x59, 0xa8, 0xdd, 0x95,
	0xc6, 0x8d, 0xef, 0x80, 0xde, 0x7a, 0x9f, 0x7d, 0x63, 0x30, 0x6b, 0x15,
	0xed, 0x2b, 0x8c, 0x78, 0x53, 0x83, 0x7f, 0x71, 0x91, 0x81, 0x6d, 0x30,
	0x80, 0x88, 0x8d, 0x58, 0x4f, 0xec, 0xbd, 0xcc, 0x0f, 0x59, 0x24, 0xaf,
	0xc4, 0xfa, 0xe9, 0x4a, 0xd3, 0xf6, 0xc7, 0xe6, 0x06, 0xc8, 0xf4, 0x32,
	0xe4, 0x92, 0xa7, 0x37, 0x06, 0x7d, 0x4c, 0x05, 0x62, 0x7f, 0x4b, 0xea,
	0x50, 0xe5, 0xb8, 0x7f, 0x10, 0x07, 0xef, 0x63, 0xb4, 0xf0, 0x23, 0xc6,
	0x4f, 0x56, 0xd0, 0x94, 0x02, 0xbe, 0x82, 0x97, 0x80, 0xdb, 0x85, 0x74,
	0xad, 0xcd, 0x6b, 0x54, 0x20, 0x50, 0x40, 0xda, 0xde, 0x7b, 0x7e, 0xb5,
	0x13, 0x49, 0x56, 0xc5, 0x6c, 0x56, 0xc5, 0xfe, 0xce, 0x37, 0x43, 0x44,
	0xf1, 0x11, 0x7b, 0xce, 0x4f, 0xef, 0xf8, 0x6b, 0x77, 0x97, 0xbd, 0x47,
	0x6c, 0xe2, 0xb5, 0xbf, 0x92, 0xa3, 0xf4, 0x04, 0xe6, 0x63, 0xd4, 0xaf,
	0x63, 0x88, 0x7d, 0xc2, 0x8d, 0x8e, 0xfc, 0x89, 0x6d, 0x28, 0x9e, 0x1b,
	0xf9, 0x1c, 0x70, 0xc4, 0x69, 0x09, 0x9a, 0x92, 0xa6, 0x6e, 0xab, 0x3e,
	0x50, 0xcf, 0x31, 0x6c, 0xf9, 0x7c, 0xf6, 0x9c, 0x92, 0x3f, 0x27, 0xc6,
	0x37, 0x75, 0x6b, 0xe7, 0xe8, 0x7b, 0x70, 0x6f, 0xe0, 0xf8, 0x3c, 0x6b,
	0x69, 0x33, 0x0a, 0xdc, 0x0f, 0xe7, 0x3d, 0x75, 0xd9, 0x0c, 0x8b, 0x3c,
	0x70, 0x6b, 0x31, 0x6f, 0x7e, 0x7e, 0x17, 0x33, 0x53, 0x8d, 0x6d, 0xd1,
	0xc5, 0x9f, 0x3b, 0x53, 0x72, 0xe1, 0x28, 0xf6, 0x03, 0x10, 0x0b, 0x7e,
	0x3e, 0x56, 0x19, 0xd1, 0xb9, 0x98, 0x44, 0xaf, 0x0f, 0x39, 0xf3, 0xab,
	0x83, 0x04, 0xfb, 0x50, 0x7a, 0x2a, 0x68, 0xff, 0x39, 0x07, 0xd2, 0x8b,
	0x2b, 0xd2, 0xfe, 0x72, 0x0d, 0x68, 0xbf, 0x66, 0xcd, 0xde, 0x5a, 0x57,
	0x34, 0x36, 0x34, 0x7e, 0x75, 0x5b, 0xbc, 0x09, 0xd6, 0x6c, 0xa1, 0x67,
	0x29, 0xb7, 0x51, 0x5b, 0x33, 0x0b, 0x7b, 0xeb, 0xa6, 0x84, 0x57, 0xff,
	0xda, 0x20, 0xdd, 0x95, 0x7b, 0x19, 0x7b, 0xb5, 0xfb, 0x6d, 0x74, 0xe6,
	0x13, 0x81, 0xec, 0xb8, 0x8b, 0x35, 0x27, 0x2e, 0xf9, 0x1f, 0x6b, 0xef,
	0xa3, 0x54, 0xdf, 0xfb, 0x4e, 0x0d, 0x96, 0xbc, 0x9a, 0x82, 0xbf, 0xf1,
	0x6a, 0x61, 0x25, 0x8f, 0xee, 0x2b, 0x35, 0xc6, 0xf6, 0x3a, 0x31, 0x1a,
	0x00, 0xa7, 0x69, 0x43, 0x3e, 0xde, 0xea, 0x4b, 0xe5, 0xb6, 0xaa, 0xd9,
	0xde, 0x54, 0x42, 0xbf, 0x94, 0x72, 0xcd, 0x9d, 0xf4, 0xec, 0x43, 0x67,
	0x34, 0xdf, 0xa9, 0xe9, 0xdd, 0xda, 0x90, 0xfd, 0xec, 0xb9, 0xe1, 0xd6,
	0xda, 0xc0, 0xf7, 0x1d, 0xd9, 0xc2, 0xfc, 0x6f, 0x52, 0xed, 0x90, 0xfa,
	0x8c, 0x00, 0x20, 0x61, 0x7a, 0xb6, 0xa2, 0x8f, 0x40, 0x2e, 0xe8, 0x77,
	0x91, 0x5e, 0x46, 0x42, 0xa2, 0x68, 0xf9, 0x17, 0xb7, 0xbf, 0x02, 0xbd,
	0xc1, 0x7b, 0x2c, 0x8b, 0x2c, 0x92, 0x0a, 0x39, 0x24, 0xd9, 0x7e, 0x3a,
	0x3a, 0x81, 0x4d, 0x2e, 0xf5, 0x41, 0xc7, 0x18, 0xb6, 0xc4, 0x3f, 0x05,
	0xad, 0x23, 0x44, 0xd4, 0xa3, 0xe2, 0xf1, 0x91, 0x1f, 0x35, 0x44, 0x2a,
	0x1c, 0x2e, 0x53, 0xca, 0x05, 0x7b, 0xd6, 0x20, 0xbe, 0x3a, 0x19, 0x57,
	0x14, 0x05, 0x60, 0x54, 0xde, 0xd3, 0xfb, 0xf5, 0x0b, 0xf4, 0x6d, 0x31,
	0x7a, 0x20, 0x3c, 0x7f,
};

struct x509_checker_options {
	struct lc_x509_certificate cert;
	struct lc_dilithium_sk sk;
	struct lc_dilithium_pk pk;
	uint8_t ipaddr[16];
	uint8_t *raw_skid;
	size_t raw_skid_size;
	uint8_t *raw_akid;
	size_t raw_akid_size;
	uint8_t *raw_serial;
	size_t raw_serial_size;
};

static int x509_gen_cert(struct x509_checker_options *opts)
{
	struct lc_x509_certificate pcert = { 0 };
	struct lc_x509_certificate *gcert = &opts->cert;
	struct x509_parse_context pctx = { 0 };
	struct x509_generate_context gctx = { 0 };
	uint8_t data[65536] = { 0 };
	size_t avail_datalen = sizeof(data), datalen;
	int ret;

	printf("In-Key Usage: %u\n", gcert->pub.key_usage);
	printf("In-EKU: %u\n", gcert->pub.key_eku);
	printf("In-CA: %u\n", gcert->pub.ca_pathlen);
	printf("In-SAN-DNS: %s\n", gcert->san_dns ? gcert->san_dns : "(unset)");
	if (gcert->san_ip) {
		bin2print(gcert->san_ip, gcert->san_ip_len, stdout,
			  "In-SAN IP");
	}
	if (gcert->raw_skid) {
		bin2print(gcert->raw_skid, gcert->raw_skid_size, stdout,
			  "SKID");
	}

	/* Encode the input data */
	gctx.cert = &opts->cert;
	CKINT(asn1_ber_encoder(&x509_encoder, &gctx, data, &avail_datalen));
	datalen = sizeof(data) - avail_datalen;

	bin2print(data, datalen, stdout, "X.509 Encoding");

	/* Decode the just encoded data into new output structure */
	pctx.cert = &pcert;
	pctx.data = data;
	CKINT(asn1_ber_decoder(&x509_decoder, &pctx, data, datalen));

	if (gcert->raw_akid_size) {
		CKINT(asn1_ber_decoder(&x509_akid_decoder, &pctx, pctx.raw_akid,
				       pctx.raw_akid_size));
	}

	/*
	 * Remove the present flag for the comparison as this is artificially
	 * added by the parser.
	 */
	pcert.pub.key_usage &= (uint16_t)~(LC_KEY_USAGE_EXTENSION_PRESENT);
	printf("Out-Key Usage: %u\n", pcert.pub.key_usage);

	if (gcert->pub.key_usage != pcert.pub.key_usage) {
		printf("Key Usage mismatch: original %u, parsed %u\n",
		       gcert->pub.key_usage, pcert.pub.key_usage);
		ret = -EINVAL;
	}

	/*
	 * Remove the present flag for the comparison as this is artificially
	 * added by the parser.
	 */
	pcert.pub.key_eku &= (uint16_t)~LC_KEY_EKU_EXTENSION_PRESENT;
	printf("Out-EKU: %u\n", pcert.pub.key_eku);

	if (gcert->pub.key_eku != pcert.pub.key_eku) {
		printf("EKU mismatch: original EKU %u, parsed EKU %u\n",
		       gcert->pub.key_eku, pcert.pub.key_eku);
		ret = -EINVAL;
	}

	printf("Out-CA: %u\n", pcert.pub.ca_pathlen);
	if (gcert->pub.ca_pathlen != pcert.pub.ca_pathlen) {
		printf("CA mismatch: original CA %u, parsed CA %u\n",
		       gcert->pub.ca_pathlen, pcert.pub.ca_pathlen);
		ret = -EINVAL;
	}

	if (pcert.san_dns_len != gcert->san_dns_len) {
		printf("SAN DNS name length mismatch (original %zu, received %zu)\n",
		       gcert->san_dns_len, pcert.san_dns_len);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.san_dns, gcert->san_dns, gcert->san_dns_len)) {
			printf("SAN DNS name mismatch (original %s, received %s)\n",
			       gcert->san_dns, pcert.san_dns);
			ret = -EINVAL;
		} else {
			printf("SAN DNS name matches\n");
		}
	}

	if (pcert.san_ip_len != gcert->san_ip_len) {
		printf("SAN IP name length mismatch (original %zu, received %zu)\n",
		       gcert->san_ip_len, pcert.san_ip_len);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.san_ip, gcert->san_ip, gcert->san_ip_len)) {
			bin2print(gcert->san_ip, gcert->san_ip_len, stdout,
				  "SAN IP mismatch original");
			bin2print(pcert.san_ip, pcert.san_ip_len, stdout,
				  "SAN IP mismatch received");
			ret = -EINVAL;
		} else {
			printf("SAN DNS name matches\n");
		}
	}

	if (gcert->raw_skid_size == 0 &&
	    pcert.raw_skid_size == LC_X509_SKID_DEFAULT_HASHSIZE) {
		printf("New SKID created\n");
	} else if (pcert.raw_skid_size != gcert->raw_skid_size) {
		printf("SKID name length mismatch (original %zu, received %zu)\n",
		       gcert->raw_skid_size, pcert.raw_skid_size);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.raw_skid, gcert->raw_skid,
			   gcert->raw_skid_size)) {
			bin2print(gcert->raw_skid, gcert->raw_skid_size, stdout,
				  "SKID mismatch original");
			bin2print(pcert.raw_skid, pcert.raw_skid_size, stdout,
				  "SKID mismatch received");
			ret = -EINVAL;
		} else {
			printf("SKID name matches\n");
		}
	}

	if (pcert.raw_akid_size != gcert->raw_akid_size) {
		printf("AKID name length mismatch (original %zu, received %zu)\n",
		       gcert->raw_akid_size, pcert.raw_akid_size);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.raw_akid, gcert->raw_akid,
			   gcert->raw_akid_size)) {
			bin2print(gcert->raw_akid, gcert->raw_akid_size, stdout,
				  "AKID mismatch original");
			bin2print(pcert.raw_akid, pcert.raw_akid_size, stdout,
				  "AKID mismatch received");
			ret = -EINVAL;
		} else {
			printf("AKID name matches\n");
		}
	}

	if (pcert.valid_from != gcert->valid_from) {
		printf("Valid From mismatch (original %llu, received %llu)\n",
		       (unsigned long long)gcert->valid_from,
		       (unsigned long long)pcert.valid_from);
		ret = -EINVAL;
	} else {
		printf("Valid From matches\n");
	}

	if (pcert.valid_to != gcert->valid_to) {
		printf("Valid To mismatch (original %llu, received %llu)\n",
		       (unsigned long long)gcert->valid_to,
		       (unsigned long long)pcert.valid_to);
		ret = -EINVAL;
	} else {
		printf("Valid To matches\n");
	}

	if (gcert->issuer_segments.cn.size != pcert.issuer_segments.cn.size) {
		printf("Issuer name length mismatch (original %u, received %u)\n",
		       gcert->issuer_segments.cn.size,
		       pcert.issuer_segments.cn.size);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.issuer_segments.cn.value,
			   gcert->issuer_segments.cn.value,
			   gcert->issuer_segments.cn.size)) {
			char buf[20];

			memcpy(buf, gcert->issuer_segments.cn.value,
			       min_size(gcert->issuer_segments.cn.size,
					sizeof(buf) - 1));
			printf("Issuer mismatch original %s\n", buf);

			memcpy(buf, pcert.issuer_segments.cn.value,
			       min_size(pcert.issuer_segments.cn.size,
					sizeof(buf) - 1));
			printf("Issuer mismatch received %s\n", buf);
			ret = -EINVAL;
		} else {
			printf("Issuer name matches\n");
		}
	}

	if (gcert->subject_segments.cn.size != pcert.subject_segments.cn.size) {
		printf("Subject name length mismatch (original %u, received %u)\n",
		       gcert->subject_segments.cn.size,
		       pcert.subject_segments.cn.size);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.subject_segments.cn.value,
			   gcert->subject_segments.cn.value,
			   gcert->subject_segments.cn.size)) {
			char buf[20];

			memcpy(buf, gcert->subject_segments.cn.value,
			       min_size(gcert->subject_segments.cn.size,
					sizeof(buf) - 1));
			printf("Subject mismatch original %s\n", buf);

			memcpy(buf, pcert.subject_segments.cn.value,
			       min_size(pcert.subject_segments.cn.size,
					sizeof(buf) - 1));
			printf("Subject mismatch received %s\n", buf);
			ret = -EINVAL;
		} else {
			printf("Subject name matches\n");
		}
	}

	if (pcert.raw_serial_size != gcert->raw_serial_size) {
		printf("Serial number length mismatch (original %zu, received %zu)\n",
		       gcert->raw_serial_size, pcert.raw_serial_size);
		ret = -EINVAL;
	} else {
		if (memcmp(pcert.raw_serial, gcert->raw_serial,
			   gcert->raw_serial_size)) {
			bin2print(gcert->raw_serial, gcert->raw_serial_size,
				  stdout, "Serial mismatch original");
			bin2print(pcert.raw_serial, pcert.raw_serial_size,
				  stdout, "Serial mismatch received");
			ret = -EINVAL;
		} else {
			printf("Serial number matches\n");
		}
	}

out:
	return ret;
}

static int x509_enc_eku(struct x509_checker_options *opts,
			const char *opt_optarg)
{
	unsigned long val;

	val = strtoul(opt_optarg, NULL, 10);
	if (val == USHRT_MAX)
		return -ERANGE;

	opts->cert.pub.key_eku = (uint16_t)val;

	return 0;
}

static int x509_enc_keyusage(struct x509_checker_options *opts,
			     const char *opt_optarg)
{
	unsigned long val;

	val = strtoul(opt_optarg, NULL, 10);
	if (val == USHRT_MAX)
		return -ERANGE;

	opts->cert.pub.key_usage = (uint16_t)val;

	return 0;
}

static int x509_enc_ca(struct x509_checker_options *opts)
{
	opts->cert.pub.ca_pathlen = LC_KEY_CA_CRITICAL | LC_KEY_CA_MAXLEN;

	return 0;
}

static int x509_enc_san_dns(struct x509_checker_options *opts,
			    const char *opt_optarg)
{
	if (!opt_optarg)
		return -EINVAL;

	opts->cert.san_dns = opt_optarg;
	opts->cert.san_dns_len = strlen(opt_optarg);

	return 0;
}

static int x509_enc_skid(struct x509_checker_options *opts,
			 const char *opt_optarg)
{
	int ret;

	if (!opt_optarg)
		return -EINVAL;

	CKINT(hex2bin_alloc(opt_optarg, strlen(opt_optarg), &opts->raw_skid,
			    &opts->raw_skid_size));

	opts->cert.raw_skid = opts->raw_skid;
	opts->cert.raw_skid_size = opts->raw_skid_size;

out:
	return ret;
}

static int x509_enc_akid(struct x509_checker_options *opts,
			 const char *opt_optarg)
{
	int ret;

	if (!opt_optarg)
		return -EINVAL;

	CKINT(hex2bin_alloc(opt_optarg, strlen(opt_optarg), &opts->raw_akid,
			    &opts->raw_akid_size));

	opts->cert.raw_akid = opts->raw_akid;
	opts->cert.raw_akid_size = opts->raw_akid_size;

out:
	return ret;
}

static void x509_clean_opts(struct x509_checker_options *opts)
{
	if (!opts)
		return;

	if (opts->raw_skid)
		free(opts->raw_skid);
	if (opts->raw_akid)
		free(opts->raw_akid);
	if (opts->raw_serial)
		free(opts->raw_serial);

	memset(opts, 0, sizeof(*opts));
}

static int x509_enc_san_ip(struct x509_checker_options *opts, char *opt_optarg)
{
	unsigned long val;
	char *saveptr = NULL;
	char *res = NULL;
	const char *tok = ".";
	unsigned int i, upper = 4;
	int ret = 0, base = 10;

	if (!opt_optarg)
		return -EINVAL;

	/* Check for IPv6 */
	if (strstr(opt_optarg, ":")) {
		tok = ":";
		upper = 16;
		base = 16;
	}

	res = strtok_r(opt_optarg, tok, &saveptr);
	for (i = 0; i < upper; i++) {
		CKNULL(res, -EINVAL);
		val = strtoul(res, NULL, base);
		if (val > 255)
			return -EINVAL;
		opts->ipaddr[i] = (uint8_t)val;
		res = strtok_r(NULL, tok, &saveptr);
	}

	opts->cert.san_ip = opts->ipaddr;
	opts->cert.san_ip_len = i;

out:
	return ret;
}

static int x509_enc_valid_from(struct x509_checker_options *opts,
			       const char *opt_optarg)
{
	unsigned long long val;

	val = strtoull(opt_optarg, NULL, 10);
	if (val == ULLONG_MAX)
		return -ERANGE;

	opts->cert.valid_from = (time64_t)val;

	return 0;
}

static int x509_enc_valid_to(struct x509_checker_options *opts,
			     const char *opt_optarg)
{
	unsigned long long val;

	val = strtoull(opt_optarg, NULL, 10);
	if (val == ULLONG_MAX)
		return -ERANGE;

	opts->cert.valid_to = (time64_t)val;

	return 0;
}

static int x509_enc_subject_cn(struct x509_checker_options *opts,
			       const char *opt_optarg)
{
	size_t len = strlen(opt_optarg);

	if (len > 0xff)
		return -EOVERFLOW;

	opts->cert.subject_segments.cn.value = opt_optarg;
	opts->cert.subject_segments.cn.size = (uint8_t)len;
	return 0;
}

static int x509_enc_issuer_cn(struct x509_checker_options *opts,
			      const char *opt_optarg)
{
	size_t len = strlen(opt_optarg);

	if (len > 0xff)
		return -EOVERFLOW;

	opts->cert.issuer_segments.cn.value = opt_optarg;
	opts->cert.issuer_segments.cn.size = (uint8_t)len;
	return 0;
}

static int x509_enc_serial(struct x509_checker_options *opts,
			   const char *opt_optarg)
{
	int ret;

	if (!opt_optarg)
		return -EINVAL;

	CKINT(hex2bin_alloc(opt_optarg, strlen(opt_optarg), &opts->raw_serial,
			    &opts->raw_serial_size));

	opts->cert.raw_serial = opts->raw_serial;
	opts->cert.raw_serial_size = opts->raw_serial_size;

out:
	return ret;
}

static int x509_enc_crypto_algo(struct x509_checker_options *opts)
{
	struct lc_x509_certificate *gcert = &opts->cert;
	int ret;

	/* Using pre-set keys avoids delay due to keygen self-test */
	//CKINT(lc_dilithium_keypair(&opts->pk, &opts->sk, lc_seeded_rng,
	//			   LC_DILITHIUM_44));
	CKINT(lc_dilithium_pk_load(&opts->pk, dilithium44_pk,
				   sizeof(dilithium44_pk)));
	CKINT(lc_dilithium_sk_load(&opts->sk, dilithium44_sk,
				   sizeof(dilithium44_sk)));

	CKINT(lc_x509_cert_set_signer_keypair_dilithium(gcert, &opts->pk,
							&opts->sk));
	CKINT(lc_x509_cert_set_pubkey_dilithium(gcert, &opts->pk));

out:
	return ret;
}

static void asn1_usage(void)
{
	fprintf(stderr, "\nASN.1 Encoder tester\n");

	fprintf(stderr, "\nUsage:\n");
	fprintf(stderr, "\t[OPTION]... FILE...\n");

	fprintf(stderr, "\nOptions:\n");
	fprintf(stderr,
		"\t   --eku\t\tencode extended key usage (use LC_KEY_EKU_* flags)\n");
	fprintf(stderr,
		"\t   --keyusage\t\tencode key usage (use LC_KEY_USAGE* flags)\n");
	fprintf(stderr,
		"\t   --ca\t\tencode CA basic constraint with criticality\n");
	fprintf(stderr, "\t   --san-dns\t\tencode SAN DNS name\n");
	fprintf(stderr, "\t   --san-ip\t\tencode SAN IP name\n");
	fprintf(stderr, "\t   --skid\t\tencode SKID (in hex form)\n");
	fprintf(stderr, "\t   --akid\t\tencode AKID (in hex form)\n");
	fprintf(stderr, "\t   --valid-from\t\tencode start time\n");
	fprintf(stderr, "\t   --valid-to\t\tencode end time\n");
	fprintf(stderr, "\t   --subject-cn\t\tencode subject CN\n");
	fprintf(stderr, "\t   --issuer-cn\t\tencode subject CN\n");
	fprintf(stderr, "\t   --serial\t\tencode serial numer (in hex form)\n");

	fprintf(stderr, "\t-h  --help\t\tPrint this help text\n");
}

int main(int argc, char *argv[])
{
	struct x509_checker_options parsed_opts = { 0 };
	int ret = 0, opt_index = 0;

	static const char *opts_short = "h";
	static const struct option opts[] = { { "help", 0, 0, 'h' },

					      { "eku", 1, 0, 0 },
					      { "ca", 0, 0, 0 },
					      { "san-dns", 1, 0, 0 },
					      { "san-ip", 1, 0, 0 },
					      { "keyusage", 1, 0, 0 },
					      { "skid", 1, 0, 0 },
					      { "akid", 1, 0, 0 },
					      { "valid-from", 1, 0, 0 },
					      { "valid-to", 1, 0, 0 },
					      { "subject-cn", 1, 0, 0 },
					      { "issuer-cn", 1, 0, 0 },
					      { "serial", 1, 0, 0 },

					      { 0, 0, 0, 0 } };

	opterr = 0;
	while (1) {
		int c = getopt_long(argc, argv, opts_short, opts, &opt_index);

		if (-1 == c)
			break;
		switch (c) {
		case 0:
			switch (opt_index) {
			/* help */
			case 0:
				asn1_usage();
				goto out;

			/* eku */
			case 1:
				CKINT(x509_enc_eku(&parsed_opts, optarg));
				break;
			/* ca */
			case 2:
				CKINT(x509_enc_ca(&parsed_opts));
				break;
			/* san-dns */
			case 3:
				CKINT(x509_enc_san_dns(&parsed_opts, optarg));
				break;
			/* san-ip */
			case 4:
				CKINT(x509_enc_san_ip(&parsed_opts, optarg));
				break;
			/* keyusage */
			case 5:
				CKINT(x509_enc_keyusage(&parsed_opts, optarg));
				break;
			/* skid */
			case 6:
				CKINT(x509_enc_skid(&parsed_opts, optarg));
				break;
			/* akid */
			case 7:
				CKINT(x509_enc_akid(&parsed_opts, optarg));
				break;
			/* valid-from */
			case 8:
				CKINT(x509_enc_valid_from(&parsed_opts,
							  optarg));
				break;
			/* valid-to */
			case 9:
				CKINT(x509_enc_valid_to(&parsed_opts, optarg));
				break;
			/* subject-cn */
			case 10:
				CKINT(x509_enc_subject_cn(&parsed_opts,
							  optarg));
				break;
			/* issuer-cn */
			case 11:
				CKINT(x509_enc_issuer_cn(&parsed_opts, optarg));
				break;
			/* serial */
			case 12:
				CKINT(x509_enc_serial(&parsed_opts, optarg));
				break;
			}
			break;

		case 'h':
			asn1_usage();
			goto out;

		default:
			asn1_usage();
			ret = -1;
			goto out;
		}
	}

	CKINT(x509_enc_crypto_algo(&parsed_opts));

	CKINT(x509_gen_cert(&parsed_opts));
	//CKINT(x509_gen_cert_extensions(&parsed_opts));
	//CKINT(x509_gen_cert_eku(&parsed_opts));

out:
	x509_clean_opts(&parsed_opts);
	return -ret;
}
